from ninja import Router
from ninja.pagination import paginate, PageNumberPagination
from typing import List
from vulnerability_analysis.schemas import (
    MobileDeviceSchema, 
    MobileDeviceResponse,
    MessageResponse,
    ErrorResponse
)
from vulnerability_analysis.models import MobileDevice
router = Router()

@router.post("/create", response={201: MobileDeviceResponse, 400: ErrorResponse})
async def create_device(request, payload: MobileDeviceSchema):
    device = await MobileDevice.objects.acreate(**payload.dict())
    return 201, device



@router.get("/all", response={200: list[MobileDeviceResponse], 404: ErrorResponse})
@paginate(PageNumberPagination)
def list_devices(request):
    return MobileDevice.objects.all()

@router.get("/{device_id}", response={200: MobileDeviceResponse, 404: ErrorResponse})
async def get_device(request, device_id: int):
    return await MobileDevice.objects.aget(id=device_id) 