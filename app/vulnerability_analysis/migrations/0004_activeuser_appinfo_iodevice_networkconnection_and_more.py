# Generated by Django 5.1 on 2025-06-07 09:11

import uuid
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ("vulnerability_analysis", "0003_alter_appvulnerability_title"),
    ]

    operations = [
        migrations.CreateModel(
            name="ActiveUser",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("device_name", models.CharField(max_length=255)),
                ("user_name", models.CharField(max_length=255)),
                ("user_id", models.CharField(max_length=255)),
                ("user_type", models.CharField(max_length=50)),
                ("login_type", models.CharField(max_length=50)),
                ("logged_in_at", models.DateTimeField(auto_now_add=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
            options={
                "verbose_name": "Active User",
                "verbose_name_plural": "Active Users",
                "ordering": ["-created_at"],
                "unique_together": {
                    ("device_name", "user_name", "user_id", "user_type")
                },
            },
        ),
        migrations.CreateModel(
            name="AppInfo",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("device_name", models.CharField(max_length=255)),
                ("file_path", models.CharField(max_length=255)),
                ("apk_path", models.CharField(max_length=255)),
                ("apk_version", models.CharField(max_length=5)),
                ("package_name", models.CharField(max_length=255)),
                ("package_type", models.CharField(max_length=255)),
                ("app_status", models.CharField(max_length=255)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
            options={
                "verbose_name": "App Info",
                "verbose_name_plural": "App Infos",
                "ordering": ["-created_at"],
                "unique_together": {("device_name", "file_path", "apk_path")},
            },
        ),
        migrations.CreateModel(
            name="IODevice",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("device_name", models.CharField(max_length=255)),
                ("name", models.CharField(max_length=255)),
                ("device_path", models.CharField(max_length=255)),
                ("device_type", models.CharField(max_length=50)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("status", models.CharField(blank=True, max_length=50, null=True)),
            ],
            options={
                "verbose_name": "IO Device",
                "verbose_name_plural": "IO Devices",
                "ordering": ["-created_at"],
                "unique_together": {("device_name", "device_path", "device_type")},
            },
        ),
        migrations.CreateModel(
            name="NetworkConnection",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("device_name", models.CharField(max_length=255)),
                ("protocol", models.CharField(max_length=10)),
                ("version", models.CharField(max_length=10)),
                ("local_address", models.CharField(max_length=50)),
                (
                    "foreign_address",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
                ("process_id", models.CharField(max_length=100)),
                ("program_name", models.CharField(max_length=255)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("connection_status", models.CharField(max_length=50)),
            ],
            options={
                "verbose_name": "Network Connection",
                "verbose_name_plural": "Network Connections",
                "ordering": ["-created_at"],
                "unique_together": {
                    (
                        "device_name",
                        "local_address",
                        "foreign_address",
                        "process_id",
                        "program_name",
                        "protocol",
                    )
                },
            },
        ),
        migrations.CreateModel(
            name="ProcessHeartbeat",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("device_name", models.CharField(max_length=255)),
                ("process_id", models.CharField(max_length=100)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("status", models.CharField(blank=True, max_length=50, null=True)),
                ("is_connected_to_network", models.BooleanField(default=False)),
                ("is_connected_to_io", models.BooleanField(default=False)),
                (
                    "local_network_socket",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
                (
                    "remote_network_socket",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
                (
                    "network_protocol",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
                (
                    "network_connection_status",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
                (
                    "program_name",
                    models.CharField(blank=True, max_length=255, null=True),
                ),
                ("io_path", models.CharField(blank=True, max_length=255, null=True)),
                (
                    "io_comand_name",
                    models.CharField(blank=True, max_length=255, null=True),
                ),
                (
                    "io_user_name",
                    models.CharField(blank=True, max_length=255, null=True),
                ),
            ],
            options={
                "verbose_name": "Process Heartbeat",
                "verbose_name_plural": "Process Heartbeats",
                "ordering": ["-created_at"],
                "unique_together": {("device_name", "process_id", "created_at")},
            },
        ),
        migrations.CreateModel(
            name="ProcessInfo",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("device_name", models.CharField(max_length=255)),
                ("process_id", models.CharField(max_length=100)),
                ("process_name", models.CharField(max_length=255)),
                ("first_timestamp", models.DateTimeField(auto_now_add=True)),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
            ],
            options={
                "verbose_name": "Process Info",
                "verbose_name_plural": "Process Infos",
                "ordering": ["-created_at"],
                "unique_together": {("device_name", "process_id", "process_name")},
            },
        ),
        migrations.CreateModel(
            name="ProcessLog",
            fields=[
                (
                    "id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("device_name", models.CharField(max_length=255)),
                ("process_id", models.CharField(max_length=100)),
                ("message", models.TextField()),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                (
                    "metric_type",
                    models.CharField(
                        choices=[("app", "app"), ("network", "network"), ("io", "io")],
                        max_length=50,
                    ),
                ),
                (
                    "log_timestamp",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
            ],
            options={
                "verbose_name": "Process Log",
                "verbose_name_plural": "Process Logs",
                "ordering": ["-created_at"],
                "unique_together": {
                    ("device_name", "process_id", "metric_type", "log_timestamp")
                },
            },
        ),
    ]
